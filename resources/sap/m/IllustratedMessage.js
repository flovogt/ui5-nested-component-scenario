/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/m/Text","sap/m/Title","sap/m/FormattedText","sap/m/Illustration","sap/ui/core/Control","sap/ui/core/Core","sap/ui/core/library","sap/ui/core/ResizeHandler","sap/ui/thirdparty/jquery","./IllustratedMessageRenderer"],function(e,t,i,s,a,o,r,l,n,p,u){"use strict";var T=e.IllustratedMessageSize;var d=e.IllustratedMessageType;var I=l.TextAlign;var S=o.extend("sap.m.IllustratedMessage",{metadata:{library:"sap.m",properties:{description:{type:"string",group:"Misc",defaultValue:""},enableFormattedText:{type:"boolean",group:"Appearance",defaultValue:false},illustrationSize:{type:"sap.m.IllustratedMessageSize",group:"Appearance",defaultValue:T.Auto},illustrationType:{type:"string",group:"Appearance",defaultValue:d.NoSearchResults},title:{type:"string",group:"Misc",defaultValue:""}},aggregations:{additionalContent:{type:"sap.m.Button",multiple:true},_formattedText:{type:"sap.m.FormattedText",multiple:false,visibility:"hidden"},_illustration:{type:"sap.m.Illustration",visibility:"hidden",multiple:false},_text:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_title:{type:"sap.m.Title",multiple:false,visibility:"hidden"}},dnd:{draggable:false,droppable:true}}});S.ORIGINAL_TEXTS={UnableToLoad:"UnableToLoad",UnableToUpload:"UnableToUpload",NoActivities:"NoActivities",BeforeSearch:"BeforeSearch",NoSearchResults:"NoSearchResults",NoEntries:"NoEntries",NoData:"NoData",NoNotifications:"NoNotifications",BalloonSky:"BalloonSky",SuccessScreen:"SuccessScreen",NoMail:"NoMail",NoSavedItems:"NoSavedItems",NoTasks:"NoTasks"};S.FALLBACK_TEXTS={ReloadScreen:S.ORIGINAL_TEXTS.UnableToLoad,Connection:S.ORIGINAL_TEXTS.UnableToLoad,ErrorScreen:S.ORIGINAL_TEXTS.UnableToUpload,EmptyCalendar:S.ORIGINAL_TEXTS.NoActivities,SearchEarth:S.ORIGINAL_TEXTS.BeforeSearch,SearchFolder:S.ORIGINAL_TEXTS.NoSearchResults,EmptyList:S.ORIGINAL_TEXTS.NoEntries,Tent:S.ORIGINAL_TEXTS.NoData,SleepingBell:S.ORIGINAL_TEXTS.NoNotifications,SimpleBalloon:S.ORIGINAL_TEXTS.BalloonSky,SimpleBell:S.ORIGINAL_TEXTS.NoNotifications,SimpleCalendar:S.ORIGINAL_TEXTS.NoActivities,SimpleCheckmark:S.ORIGINAL_TEXTS.SuccessScreen,SimpleConnection:S.ORIGINAL_TEXTS.UnableToLoad,SimpleEmptyDoc:S.ORIGINAL_TEXTS.NoData,SimpleEmptyList:S.ORIGINAL_TEXTS.NoEntries,SimpleError:S.ORIGINAL_TEXTS.UnableToUpload,SimpleMagnifier:S.ORIGINAL_TEXTS.BeforeSearch,SimpleMail:S.ORIGINAL_TEXTS.NoMail,SimpleNoSavedItems:S.ORIGINAL_TEXTS.NoSavedItems,SimpleNotFoundMagnifier:S.ORIGINAL_TEXTS.NoSearchResults,SimpleReload:S.ORIGINAL_TEXTS.UnableToLoad,SimpleTask:S.ORIGINAL_TEXTS.NoTasks};S.PREPENDS={DESCRIPTION:"IllustratedMessage_DESCRIPTION_",TITLE:"IllustratedMessage_TITLE_"};S.BREAK_POINTS={DIALOG:679,SPOT:319,BASE:259};S.MEDIA={BASE:"sapFIllustratedMessage-Base",SPOT:"sapFIllustratedMessage-Spot",DIALOG:"sapFIllustratedMessage-Dialog",SCENE:"sapFIllustratedMessage-Scene"};S.RESIZE_HANDLER_ID={CONTENT:"_sContentResizeHandlerId"};S.prototype.init=function(){this._updateInternalIllustrationSetAndType(this.getIllustrationType())};S.prototype.onBeforeRendering=function(){this._detachResizeHandlers()};S.prototype.onAfterRendering=function(){this._updateDomSize();this._attachResizeHandlers();this._preventWidowWords(this._getTitle().getDomRef());this._preventWidowWords(this._getDescription().getDomRef())};S.prototype.exit=function(){this._detachResizeHandlers()};S.prototype.setIllustrationType=function(e){if(this.getIllustrationType()===e){return this}this._updateInternalIllustrationSetAndType(e);return this.setProperty("illustrationType",e)};S.prototype._getDefaultDescription=function(){return this._findDefaultText(S.PREPENDS.DESCRIPTION)};S.prototype._getDefaultTitle=function(){return this._findDefaultText(S.PREPENDS.TITLE)};S.prototype._findDefaultText=function(e){var t=this._getResourceBundle();return t.getText(e+this._sIllustrationType,null,true)||t.getText(e+this._sIllustrationType.substr(0,this._sIllustrationType.indexOf("_v")),null,true)||t.getText(e+S.FALLBACK_TEXTS[this._sIllustrationType],null,true)};S.prototype._getDescription=function(){return this.getEnableFormattedText()?this._getFormattedText():this._getText()};S.prototype._getFormattedText=function(){var e=this.getDescription(),t=this.getAggregation("_formattedText");if(!t){t=new s({textAlign:I.Center});this.setAggregation("_formattedText",t)}if(e){t.setHtmlText(e)}else{t.setHtmlText(this._getDefaultDescription())}return t};S.prototype._getIllustration=function(){var e=this.getAggregation("_illustration");if(!e){e=new a;this.setAggregation("_illustration",e)}return e};S.prototype._getResourceBundle=function(){return r.getLibraryResourceBundle("sap.m")};S.prototype._getText=function(){var e=this.getDescription(),i=this.getAggregation("_text");if(!i){i=new t({textAlign:I.Center});this.setAggregation("_text",i)}if(e){i.setText(e)}else{i.setText(this._getDefaultDescription())}return i};S.prototype._getTitle=function(){var e=this.getTitle(),t=this.getAggregation("_title");if(!t){t=new i({wrapping:true});this.setAggregation("_title",t)}if(e){t.setText(e)}else{t.setText(this._getDefaultTitle())}return t};S.prototype._preventWidowWords=function(e){var t,i,s=window.HTMLElement;if(!(s&&e instanceof s)){return}t=p(e);i=t.html();i=i.replace(/ ([^ ]*)$/,"&nbsp;$1");t.html(i)};S.prototype._updateDomSize=function(){var e=this.getDomRef(),t;if(e){t=this.getIllustrationSize();if(t===T.Auto){this._updateMedia(e.getBoundingClientRect().width)}else{this._updateMediaStyle(S.MEDIA[t.toUpperCase()])}}};S.prototype._updateInternalIllustrationSetAndType=function(e){var t=e.split("-");this._sIllustrationSet=t[0];this._sIllustrationType=t[1]};S.prototype._onResize=function(e){var t=e.size.width;this._updateMedia(t)};S.prototype._updateMedia=function(e){if(!e){return}if(e<=S.BREAK_POINTS.BASE){this._updateMediaStyle(S.MEDIA.BASE)}else if(e<=S.BREAK_POINTS.SPOT){this._updateMediaStyle(S.MEDIA.SPOT)}else if(e<=S.BREAK_POINTS.DIALOG){this._updateMediaStyle(S.MEDIA.DIALOG)}else{this._updateMediaStyle(S.MEDIA.SCENE)}};S.prototype._updateMediaStyle=function(e){Object.keys(S.MEDIA).forEach(function(t){var i=e===S.MEDIA[t],s=t.charAt(0)+t.slice(1).toLowerCase();this.toggleStyleClass(S.MEDIA[t],i);if(i&&e!==S.MEDIA.BASE){this._getIllustration().setSet(this._sIllustrationSet,true).setMedia(s,true).setType(this._sIllustrationType)}},this)};S.prototype._attachResizeHandlers=function(){var e=this.getIllustrationSize();if(this.getDomRef()&&e===T.Auto){this._registerResizeHandler(S.RESIZE_HANDLER_ID.CONTENT,this,this._onResize.bind(this))}};S.prototype._detachResizeHandlers=function(){this._deRegisterResizeHandler(S.RESIZE_HANDLER_ID.CONTENT)};S.prototype._registerResizeHandler=function(e,t,i){if(!this[e]){this[e]=n.register(t,i)}};S.prototype._deRegisterResizeHandler=function(e){if(this[e]){n.deregister(this[e]);this[e]=null}};S.prototype.getAccessibilityReferences=function(){return{title:this._getTitle().getId(),description:this._getDescription().getId()}};return S});