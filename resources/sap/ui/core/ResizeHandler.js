/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/ui/base/Object","sap/ui/core/IntervalTrigger","sap/ui/thirdparty/jquery","sap/ui/util/ActivityDetection"],function(e,t,i,jQuery,s){"use strict";var n=e.getLogger("sap.ui.core.ResizeHandler",e.Level.ERROR);var r;var o=t.extend("sap.ui.core.ResizeHandler",{constructor:function(){t.apply(this);this.aResizeListeners=[];this.aSuspendedDomRefs=[];this.bRegistered=false;this.mCallbacks=new Map;this.iIdCounter=0;this.fnDestroyHandler=this.destroy.bind(this);jQuery(window).on("unload",this.fnDestroyHandler);s.attachActivate(d,this);if(r){n.error("ResizeHandler is designed as a singleton and should not be created manually! "+"Please require 'sap/ui/core/ResizeHandler' instead and use the module export directly without using 'new'.")}}});function a(){if(this.bRegistered){this.bRegistered=false;i.removeListener(this.checkSizes,this)}}function d(){if(!this.bRegistered&&this.aResizeListeners.length>0){this.bRegistered=true;i.addListener(this.checkSizes,this)}}o.prototype.destroy=function(e){s.detachActivate(d,this);jQuery(window).off("unload",this.fnDestroyHandler);this.aResizeListeners=[];this.aSuspendedDomRefs=[];a.call(this)};o.prototype.attachListener=function(e,i){var s=t.isA(e,"sap.ui.core.Control"),r=e instanceof jQuery,o=s?e.getDomRef():e,a=o?o.offsetWidth:0,u=o?o.offsetHeight:0,f="rs-"+Date.now()+"-"+this.iIdCounter++,h;if(s){h="Control "+e.getId()}else if(e.id){h=e.id}else{h=String(e)}this.aResizeListeners.push({sId:f,oDomRef:s?null:e,oControl:s?e:null,bIsJQuery:r,fHandler:i,iWidth:a,iHeight:u,dbg:h});n.debug("registered "+h);d.call(this);return f};o.prototype.detachListener=function(e){var t=this.aResizeListeners;for(var i=0;i<t.length;i++){if(t[i].sId===e){t.splice(i,1);n.debug("deregistered "+e);break}}if(t.length===0){a.call(this)}};o.prototype.checkSizes=function(){var e=n.isLoggable();if(e){n.debug("checkSizes:")}this.aResizeListeners.forEach(function(t){if(t){var i=!!t.oControl,s=i?t.oControl.getDomRef():t.oDomRef;s=t.bIsJQuery?s[0]:s;if(s&&document.documentElement.contains(s)&&!this._isSuspended(s)){var r=t.iWidth,o=t.iHeight,a=s.offsetWidth,d=s.offsetHeight;if(r!=a||o!=d){t.iWidth=a;t.iHeight=d;var u=jQuery.Event("resize");u.target=s;u.currentTarget=s;u.size={width:a,height:d};u.oldSize={width:r,height:o};u.control=i?t.oControl:null;if(e){n.debug("resize detected for '"+t.dbg+"': "+u.oldSize.width+"x"+u.oldSize.height+" -> "+u.size.width+"x"+u.size.height)}t.fHandler(u)}}}},this);if(o._keepActive!=true&&o._keepActive!=false){o._keepActive=false}if(!s.isActive()&&!o._keepActive){a.call(this)}};o.register=function(e,t){return r.attachListener(e,t)};o.deregister=function(e){r.detachListener(e)};o.deregisterAllForControl=function(e){r.aResizeListeners.filter(function(t){return t&&t.oControl&&t.oControl.getId()===e}).forEach(function(e){o.deregister(e.sId)})};o.suspend=function(e){if(!document.documentElement.contains(e)){return false}if(r.aSuspendedDomRefs.indexOf(e)===-1){r.aSuspendedDomRefs.push(e)}return true};o.resume=function(e){var t=r.aSuspendedDomRefs.indexOf(e);if(t===-1){return false}r.aSuspendedDomRefs.splice(t,1);r.checkSizes();var i=r.mCallbacks.get(e);if(i){for(var s=0;s<i.length;s++){i[s]()}r.mCallbacks.delete(e)}return true};o.prototype._isSuspended=function(e){var t=this.aSuspendedDomRefs,i;for(var s=0;s<t.length;s++){i=t[s];if(i.contains(e)){return i}}return false};o.isSuspended=function(e,t){var i=r._isSuspended(e);if(t&&i){var s=r.mCallbacks.get(i);if(!s){s=[];r.mCallbacks.set(i,s)}if(s.indexOf(t)===-1){s.push(t)}}return!!i};r=new o;return o});
//# sourceMappingURL=ResizeHandler.js.map