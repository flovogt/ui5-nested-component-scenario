/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/events/jquery/EventTriggerHook","sap/base/Log","sap/ui/thirdparty/jquery"],function(e,t,jQuery){"use strict";var i={},a=["focusin","focusout","keydown","keypress","keyup","mousedown","touchstart","touchmove","mouseup","touchend","click"],n=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr|tr)$/i;i.block=function(e,i,a){var r,l,c,u;if(e){r=e.getDomRef(a);if(!r){r=e.getDomRef()}if(!r){t.warning("BlockLayer could not be rendered. The outer Control instance is not valid anymore or was not rendered yet.");return}l=r.tagName;if(n.test(l)){t.warning("BusyIndicator cannot be placed in elements with tag '"+l+"'.");return}u=s(r,i);c={$parent:jQuery(r),$blockLayer:jQuery(u),control:e};if(c.$parent.css("position")=="static"){if(r.style&&r.style.position==="static"){c.originalPosition="static"}c.$parent.css("position","relative");c.positionChanged=true}o.call(c,true)}else{t.warning("BlockLayer couldn't be created. No Control instance given.")}return c};i.unblock=function(e){if(e){if(e.originalPosition){e.$parent.css("position",e.originalPosition)}else if(e.positionChanged){e.$parent.css("position","")}o.call(e,false);e.$blockLayer.remove()}};i.toggleAnimationStyle=function(e,t){var i=jQuery(e.$blockLayer.get(0));if(t){i.removeClass("sapUiHiddenBusyIndicatorAnimation");i.removeClass("sapUiBlockLayerOnly")}else{i.addClass("sapUiBlockLayerOnly");i.addClass("sapUiHiddenBusyIndicatorAnimation")}};function s(e,t){var i=document.createElement("div");i.id=t;i.classList.add("sapUiBlockLayer","sapUiSkipFocusFail");i.setAttribute("tabindex","0");e.appendChild(i);return i}function o(i){if(i){var n=this.$parent.get(0);if(n){this.fnRedirectFocus=o.bind(this);this.oTabbableBefore=r(this.fnRedirectFocus);this.oTabbableAfter=r(this.fnRedirectFocus);n.parentNode.insertBefore(this.oTabbableBefore,n);n.parentNode.insertBefore(this.oTabbableAfter,n.nextSibling);this._fnSuppressDefaultAndStopPropagationHandler=s.bind(this);this._aSuppressHandler=c.call(this,this._fnSuppressDefaultAndStopPropagationHandler)}else{t.warning("fnHandleInteraction called with bEnabled true, but no DOMRef exists!")}}else{if(this.oTabbableBefore){l(this.oTabbableBefore,this.fnRedirectFocus);delete this.oTabbableBefore}if(this.oTabbableAfter){l(this.oTabbableAfter,this.fnRedirectFocus);delete this.oTabbableAfter}delete this.fnRedirectFocus;u.call(this,this._fnSuppressDefaultAndStopPropagationHandler)}function s(e){var i=e.target===this.$blockLayer.get(0),a;if(i&&e.type==="keydown"&&e.keyCode===9){t.debug("Local Busy Indicator Event keydown handled: "+e.type);a=e.shiftKey?this.oTabbableBefore:this.oTabbableAfter;a.setAttribute("tabindex",-1);this.bIgnoreFocus=true;a.focus();this.bIgnoreFocus=false;a.setAttribute("tabindex",0);e.stopImmediatePropagation();return}if(i&&["mousedown","touchstart"].includes(e.type)){t.debug("Local Busy Indicator click handled on busy area: "+e.target.id);e.stopImmediatePropagation();return}const n=e.type=="keydown"&&[9,37,38,39,40].includes(e.keyCode);if(!n){t.debug("Local Busy Indicator Event Suppressed: "+e.type);e.preventDefault();e.stopImmediatePropagation()}}function o(){if(!this.bIgnoreFocus){this.$blockLayer.get(0).focus()}}function r(e){var t=document.createElement("span");t.setAttribute("tabindex",0);t.classList.add("sapUiBlockLayerTabbable","sapUiSkipFocusFail");t.addEventListener("focusin",e);return t}function l(e,t){if(e.parentNode){e.parentNode.removeChild(e)}e.removeEventListener("focusin",t)}function c(t){var i=[],n=this.$parent.get(0),s=this.$blockLayer.get(0);for(var o=0;o<a.length;o++){n.addEventListener(a[o],t,{capture:true,passive:false});i.push(e.suppress(a[o],n,s))}this.$blockLayer.on("keydown",t);return i}function u(t){var i,n=this.$parent.get(0),s=this.$blockLayer.get(0);if(n){for(i=0;i<a.length;i++){n.removeEventListener(a[i],t,{capture:true,passive:false})}}if(this._aSuppressHandler){for(i=0;i<this._aSuppressHandler.length;i++){e.release(this._aSuppressHandler[i])}}if(s){this.$blockLayer.off("keydown",t)}}}return i});
//# sourceMappingURL=BlockLayerUtils.js.map