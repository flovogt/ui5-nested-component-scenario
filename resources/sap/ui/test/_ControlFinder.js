/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/Object","sap/ui/core/Element","sap/ui/test/OpaPlugin","sap/ui/test/actions/Press","sap/ui/test/_LogCollector","sap/ui/test/_OpaLogger","sap/ui/thirdparty/jquery"],function(e,t,n,r,i,o,s){"use strict";var a=new n;var u=e.extend("sap.ui.test._ControlFinder",{});var c=o.getLogger("sap.ui.test._ControlFinder");var f=i.getInstance("^((?!autowaiter).)*$");var l=[];u._findControls=function(e){if(g(e)){try{return u._findControls(p(e))}catch(e){c.error(e);return[]}}else{var t=a._getFilteredControls(e);if(t===n.FILTER_FOUND_NO_CONTROLS){return[]}else{return Array.isArray(t)?t:[t]}}};u._findElements=function(e){f.start();var t=u._findControls(e);var n=function(e){var t=(new r).$(e)[0];if(t&&t.id){return t}else{return e.getDomRef()}};var i=t.map(function(t){switch(e.interaction){case"root":return t.getDomRef();case"focus":return t.getFocusDomRef();case"press":var i=(new r)._getAdapter(t);return t.$(i)[0];case"auto":return n(t);default:i=e.interaction&&e.interaction.idSuffix;return i?t.$(i)[0]:n(t)}});l.push(f.getAndClearLog());f.stop();return i};u._getControlForElement=function(e){var t=Object.prototype.toString.call(e)==="[object String]"?"#"+e:e;return d(u._getIdentifiedDOMElement(t))};u._getControlProperty=function(e,t){var n=s.extend({},e.mProperties,{id:e.getId()});return Object.keys(n).indexOf(t)>-1?n[t]:null};u._getDomElementIDSuffix=function(e,t){var n=e.id;var r="-";var i=t.getId().length;return n.charAt(i)===r&&n.substring(i+1)};u._getIdentifiedDOMElement=function(e){if(typeof e==="string"){e=e.replace(/(:|\.|\[|\]|,|=|@)/g,"\\$1")}return s(e).closest("[data-sap-ui]")};u._getIdentifiedDOMElementId=function(e){var t=u._getIdentifiedDOMElement(e);return t.attr("data-sap-ui")};u._getLatestLog=function(){return l&&l.pop()};u._isControlInStaticArea=function(e){var t=sap.ui.getCore().getStaticAreaRef();return s.contains(t,e.getDomRef())};var d=function(e){return t.closestTo(e[0])};if(typeof t.closestTo!=="function"){d=function(e){return jQuery(e).control(0)}}function g(e){return e.ancestor||e.descendant||e.sibling}function p(e){var t={};if(e.ancestor){var n=_(e);var r=u._findControls(n)[0];if(r){t.ancestor=r;delete e.ancestor}else{throw new Error("Ancestor not found using selector: "+JSON.stringify(n))}}if(e.descendant){var i=u._findControls(e.descendant)[0];if(i){t.descendant=i;delete e.descendant}else{throw new Error("Descendant not found using selector: "+JSON.stringify(e.descendant))}}if(e.sibling){if(Array.isArray(e.sibling)){var o=u._findControls(e.sibling[0])[0];if(o){t.sibling=[[o,e.sibling[1]]];delete e.sibling}}else{var o=u._findControls(e.sibling)[0];if(o){t.sibling=o;delete e.sibling}else{throw new Error("Sibling not found using selector: "+JSON.stringify(e.sibling))}}}if(s.isEmptyObject(t)){return e}else{return s.extend({},e,{matchers:t})}}function _(e){if(Array.isArray(e.ancestor)){return{id:e.ancestor[0]}}else{return e.ancestor}}return u});
//# sourceMappingURL=_ControlFinder.js.map