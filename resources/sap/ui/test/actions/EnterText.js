/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/extend","sap/ui/base/ManagedObject","sap/ui/test/actions/Action","sap/ui/events/KeyCodes","sap/ui/thirdparty/jquery"],function(e,t,n,i,jQuery){"use strict";var r=n.extend("sap.ui.test.actions.EnterText",{metadata:{properties:{text:{type:"string"},clearTextFirst:{type:"boolean",defaultValue:true},keepFocus:{type:"boolean",defaultValue:false},pressEnterKey:{type:"boolean",defaultValue:false}},publicMethods:["executeOn"]},constructor:function(e){if(e&&e.text){e.text=t.escapeSettingsValue(e.text)}n.prototype.constructor.call(this,e)},init:function(){n.prototype.init.apply(this,arguments);this.controlAdapters=e(this.controlAdapters,r.controlAdapters)},executeOn:function(e){var t=this.$(e),n=t[0];if(!n){return}if(this.getText()===undefined||!this.getClearTextFirst()&&!this.getText()){this.oLogger.error("Please provide a text for this EnterText action");return}if(n.readOnly){this.oLogger.debug("Cannot enter text in control "+e+": control is not editable!");return}if(n.disabled){this.oLogger.debug("Cannot enter text in control "+e+": control is not enabled!");return}if(this.getText().length&&n.selectionStart===undefined&&n.selectionEnd===undefined){this.oLogger.debug("Cannot enter text in control "+e+": The control's DOM element does not have the expected API of the html elements that accept text input: selectionStart and selectionEnd properties undefined.");return}var r=this.getUtils();this.oLogger.timestamp("opa.actions.enterText");this.oLogger.debug("Enter text in control "+e);this._tryOrSimulateFocusin(t,e);if(this.getClearTextFirst()){r.triggerKeydown(n,i.DELETE);r.triggerKeyup(n,i.DELETE);t.val("");r.triggerEvent("input",n);if(typeof n.selectionStart==="number"){n.selectionStart=0;n.selectionEnd=0}}var s=t.val();if(t[0].selectionStart!==t[0].selectionEnd&&t[0].selectionStart!==s.length){s=s.slice(0,t[0].selectionStart);t[0].setSelectionRange(t[0].selectionStart,t[0].selectionStart)}var o=this.getClearTextFirst()?"":s;var a=n.selectionStart;this.getText().split("").forEach(function(t){if(a===0||a===null){o+=t}else{var i=o.slice(0,a);var s=o.slice(a);o=i+t+s}this.triggerCharacterInput(n,t,o,e);r.triggerEvent("input",n)},this);if(this.getPressEnterKey()){r.triggerKeydown(n,i.ENTER);r.triggerKeyup(n,i.ENTER);r.triggerEvent("input",n);r.triggerEvent("search",n)}else if(!this.getKeepFocus()){this._simulateFocusout(n);r.triggerEvent("search",n)}},triggerCharacterInput:function(e,t,n,i){i.addEventDelegate({onkeypress:function(e){if(!e.isDefaultPrevented()){r()}i.removeEventDelegate(this)}});function r(){if(typeof e=="string"){e=e?document.getElementById(e):null}var i=jQuery(e);if(typeof n!=="undefined"){i.val(n)}else{i.val(i.val()+t)}}this.getUtils().triggerKeypress(e,t)}});r.controlAdapters={};r.controlAdapters["sap.m.StepInput"]="input-inner";return r});
//# sourceMappingURL=EnterText.js.map